<div xmlns:xs="http://www.w3.org/2001/XMLSchema"
     xmlns:fn="http://www.w3.org/2005/xpath-functions">
   <p>
        Guidance on interpreting the table can be found <a href="overview.html#mappings">here</a>.
      </p>
   <table class="grid"
          style="width:150%;word-break:break-word;table-layout:fixed;">
      <col style="width:15%"/>
      <col style="width:7.5%"/>
      <col style="width:7.5%"/>
      <col style="width:15%;"/>
      <col style="width:20%;"/>
      <col style="width:35%;"/>
      <thead style="background-color:PowderBlue;">
         <tr>
            <th colspan="3" style="text-align:center;">CDISC</th>
            <th colspan="2" style="text-align:center;">FHIR map (or gap)</th>
            <th rowspan="2" style="vertical-align:bottom;text-align:center;">Comment</th>
         </tr>
         <tr style="text-align:center;">
            <th style="text-align:center;">Name</th>
            <th style="text-align:center;">CDASH</th>
            <th style="text-align:center;">SDTM</th>
            <th style="text-align:center;">Element</th>
            <th style="text-align:center;">FHIRPath</th>
         </tr>
      </thead>
      <tbody>
         <tr>
            <th>Study Identifier</th>
            <td>
               <span>DM.STUDYID</span>
            </td>
            <td>
               <span>DM.STUDYID</span>
            </td>
            <td>ResearchStudy.identifier</td>
            <td>
               <p>ResearchSubject.where(subject=Observation.subject).study.resolve().partOf.resolve().identifier.value</p>
               <p>Observation.extension(workflow-researchstudy).valueReference.resolve().partOf.resolve().identifier.value</p>
            </td>
            <td>Mapping is based on presumption that research subject will be tied to site-specific ResearchStudy, which will then be part of overall ResearchStudy.<br/>
               <br/>The path using the extension will only exist if the system maintaining the Observation is aware of its relevance to the Study.</td>
         </tr>
         <tr>
            <th>Study Site Identifier</th>
            <td>
               <span>DM.SITEID</span>
            </td>
            <td>
               <span>DM.SITEID</span>
            </td>
            <td>ResearchStudy.identifier</td>
            <td>
               <p>ResearchSubject.where(subject=Observation.subject).study.resolve().identifier.value</p>
               <p>Observation.extension(workflow-researchstudy).valueReference.resolve().identifier.value</p>
            </td>
            <td>Mapping is based on presumption that research subject will be tied to site-specific ResearchStudy, which will then be part of overall ResearchStudy.<br/>
               <br/>The path using the extension will only exist if the system maintaining the Observation is aware of its relevance to the Study.</td>
         </tr>
         <tr>
            <th>Investigator Identifier</th>
            <td/>
            <td>
               <span>DM.INVID</span>
            </td>
            <td>Practitioner.identifier</td>
            <td>
               <p>ResearchSubject.where(subject=Observation.subject).study.resolve().principleInvestigator.resolve().identifier.value</p>
               <p>Observation.extension(workflow-researchstudy).valueReference.resolve().principleInvestigator.resolve().identifier.value</p>
            </td>
            <td>Will need to decide which id to expose.  If you want the PI for the overall study rather than just for the site associated with the Observation, you'll need to traverse the partOf.resolve() from the study-specific ResearchStudy.<br/>
               <br/>The path using the extension will only exist if the system maintaining the Observation is aware of its relevance to the Study.</td>
         </tr>
         <tr>
            <th>Subject Identifier for the Study</th>
            <td>
               <span>DM.SUBJID</span>
            </td>
            <td>
               <span>DM.SUBJID</span>
            </td>
            <td>ResearchSubject.identifier</td>
            <td>
               <p>ResearchSubject.where(individual=Observation.subject).identifier.value</p>
            </td>
            <td>Study subject is found by finding the StudySubject that corresponds to the same Patient and ResearchStudy as the Observation.<br/>
               <br/>No standard way to decide which subject identifier to use</td>
         </tr>
         <tr>
            <th>Visit Number</th>
            <td>
               <span>VISITNUM</span>
            </td>
            <td>
               <span>VISITNUM</span>
            </td>
            <td>Encounter.identifier</td>
            <td>
               <p>Observation.encounter.resolve().identifier</p>
            </td>
            <td>This won't necessarily correlate with the protocol-defined visit number.  Correspondance to a protocol-defined visit will typically require rules-based analysis based on time, encounter type and other factors.</td>
         </tr>
         <tr>
            <th>Visit Name</th>
            <td>
               <span>VISIT</span>
            </td>
            <td>
               <span>VISIT</span>
            </td>
            <td>ActivityDefinition.name</td>
            <td>
               <p>Observation.encounter.resolve().extension(workflow-instantiates).valueCanonical.resolve().title</p>
            </td>
            <td>In most cases, real world data won't have a direct association to a study protocol activity and the link would need to be inferred.  However, if it exists, it would map as follows:<br/>
               <br/>We could go through Encounter.basedOn-&gt; ServiceRequest.instantiatesCanonical, you arrive at ActivityDefinition.   Encounter should have a standard instantiatesCanonical extension that would allow pointing to the ActivityDefinition.  This would be the ActivityDefinition.name.  Submit a change request to add the extension</td>
         </tr>
         <tr>
            <th>Lab Specimen ID</th>
            <td>
               <span>LBREFID</span>
            </td>
            <td>
               <span>LBREFID</span>
            </td>
            <td>Specimen.accessionIdentifier</td>
            <td>
               <p>Observation.specimen.resolve().accessionIdentifier.value</p>
            </td>
            <td>As reported from the Site</td>
         </tr>
         <tr>
            <th rowspan="2">Date/Time of Specimen Collection</th>
            <td rowspan="2"/>
            <td rowspan="2">
               <span>LBDTC</span>
            </td>
            <td>Specimen.collection.collectedDateTime</td>
            <td>
               <p>Observation.specimen.resolve().collection.collectedDateTime</p>
            </td>
            <td rowspan="2">NOTE: no mapping included for CDASH LBDAT and LBTIM
To map directly, the data must be formatted in ISO 8601 date/time format (e.g., 2015-02-07T13:28:17-05:00)</td>
         </tr>
         <tr>
            <td>Specimen.collection.collectedPeriod</td>
            <td>
               <p>Observation.specimen.resolve().collection.collectedPeriod.start</p>
            </td>
         </tr>
         <tr>
            <th>End Date/Time of Specimen Collection</th>
            <td/>
            <td>
               <span>LBENDTC</span>
            </td>
            <td>Specimen.collection.collectedPeriod</td>
            <td>
               <p>Observation.specimen.resolve().collection.collectedPeriod.end</p>
            </td>
            <td>NOTE: No mapping included for CDASH LBENDAT and LBENTIM)<br/>
               <br/>To map directly, the data must be formatted in ISO 8601 date/time format (e.g., 2015-02-07T13:28:17-05:00)</td>
         </tr>
         <tr>
            <th>Specimen Collection Duration (for Clinical Research with extended time of collection)</th>
            <td>
               <span>LBCDUR</span>
            </td>
            <td>
               <span>LBDUR*</span>
            </td>
            <td>Specimen.collection.collectedPeriod</td>
            <td>
               <p>Observation.specimen.resolve().collection.collectedPeriod</p>
            </td>
            <td>Will need to convert value and unit to ISO syntax.  E.g. 90 min would convert to PT1H30M</td>
         </tr>
         <tr>
            <th>Specimen Planned Time Point Name (Planned Collection Time Point - time within Encounter)</th>
            <td>
               <span>LBCTPT</span>
            </td>
            <td>
               <span>LBTPT</span>
            </td>
            <td>Specimen.extension</td>
            <td>
               <p>Observation.specimen.resolve().extension(cqf-relativeDateTime).extension('reference').valueReference.reference.resolve().title</p>
            </td>
            <td>Typically named timepoints won't exist in real-world data and the timing point name will need to be assigned by the sponsor.  However, this shows where the data would be expressed in FHIR if it was present there.</td>
         </tr>
         <tr>
            <th>Specimen Planned Elapsed Time from Time Point Reference</th>
            <td>
               <span>LBCELTM</span>
            </td>
            <td>
               <span>LBELTM</span>
            </td>
            <td>Specimen.extension</td>
            <td>
               <p>Observation.specimen.resolve().extension(cqf-relativeDateTime).extension('offset').valueDuration</p>
            </td>
            <td>Typically named timepoints won't exist in real-world data and the timing point offset will need to be calculated by the sponsor.  However, this shows where the data would be expressed in FHIR if it was present there.  If present, would need to translate to ISO-8601</td>
         </tr>
         <tr>
            <th>Specimen Condition</th>
            <td>
               <span>LBCSPCCN</span>
            </td>
            <td>
               <span>LBSPCCND</span>
            </td>
            <td>Specimen.condition</td>
            <td>
               <p>Observation.specimen.resolve().condition.coding.code</p>
            </td>
            <td>Recommend submitting change proposals to extend the FHIR vocabulary to include CDISC values.  Sponsor will need to decide how to map when FHIR terminology contains codes not present in CDISC.<br/>
               <br/>NOTE: requires an extension to the FHIR vocabulary to include CDISC values (e.g., Refrigerated).  An "as collected" version of the SDTM variable is recommended to allow the sponsor to make adjustments to ensure terminology compliance while mapping to SDTM.</td>
         </tr>
         <tr>
            <th>Specimen Type</th>
            <td>
               <span>LBCSPEC</span>
            </td>
            <td>
               <span>LBSPEC</span>
            </td>
            <td>Specimen.type</td>
            <td>
               <p>Observation.specimen.resolve().type.coding.display</p>
            </td>
            <td>NOTE: In some cases, this may be inferred from the LOINC.<br/>
               <br/>FHIR terminology is not standardized.  Sponsor will need to map to CDISC terminology if raw data does not use CDISC codes.  An "as collected" version of the SDTM variable is recommended to allow the sponsor to make adjustments to ensure terminology compliance while mapping to SDTM.</td>
         </tr>
         <tr>
            <th>Fasting Status</th>
            <td>
               <span>LBCFAST</span>
            </td>
            <td>
               <span>LBFAST</span>
            </td>
            <td>Specimen.collection.fastingStatusCodeableConcept</td>
            <td>
               <p>Observation.specimen.resolve().collection.fastingStatusCodeableConcept.coding.code</p>
            </td>
            <td>FHIR to CDISC mapping as follows:
F -&gt; Y; NF -&gt; N; FNA -&gt; N/A; NG -&gt; Not Applicable<br/>
               <br/>If fastingStatusDuration is present and non-zero, that would also map to 'Y'.</td>
         </tr>
         <tr>
            <th>Lab Test Condition Met</th>
            <td>
               <span>LBCOND</span>
            </td>
            <td/>
            <td colspan="2" style="background-color:LightGray">This is an 'ask on entry' question.  May be able to determine some conditions, such as fasting, by using other specimen.collection attributes (e.g., fasting status).  Others might be captured as components or extensions.  Alternatively, obtain this information from the case report form entries.</td>
            <td>There are explicit elements for Specimen.collection.fastingStatus and collection.fastingDuration.  May need extensions for other pre-conditions</td>
         </tr>
         <tr>
            <th>Specimen Collection Position</th>
            <td>
               <span>LBCPOS</span>
            </td>
            <td>
               <span>LBPOS*</span>
            </td>
            <td>Specimen.collection</td>
            <td>
               <p>Observation.specimen.resolve().collection.extension(observation-bodyPosition).valueCodeableConcept</p>
            </td>
            <td>As reported from the lab.  Will need to map to CDISC controlled terminology</td>
         </tr>
         <tr>
            <th>Specimen Usability for the Test</th>
            <td>
               <span>LBCSPCUF</span>
            </td>
            <td>
               <span>LBSPCUFL*</span>
            </td>
            <td>Specimen.status</td>
            <td>
               <p>Observation.specimen.resolve()status.where($this='Unsatisfactory')</p>
            </td>
            <td>Need to translate to blank or N if not received as blank or N<br/>
               <br/>May not be applicable for safety labs.</td>
         </tr>
         <tr>
            <th rowspan="2">Category</th>
            <td rowspan="2">
               <span>LBCCAT</span>
            </td>
            <td rowspan="2">
               <span>LBCAT</span>
            </td>
            <td>DiagnosticReport.category</td>
            <td>
               <p>DiagnosticReport.category.coding.where(system='LBSCAT').code</p>
            </td>
            <td rowspan="2">NOTE: In some cases, this may be inferred from the LOINC.  It might also be found by looking for the 'panel' Obsesrvation this Observation is a part of.  In most cases, translation will be required to sponsor-defined codes.  It may work best for the sponsor to categorize based on TESTCD values and ignore lab-reported and EHR-determined categories entirely.</td>
         </tr>
         <tr>
            <td>DiagnosticReport.code</td>
            <td>
               <p>DiagnosticReport.code</p>
            </td>
         </tr>
         <tr>
            <th rowspan="2">Test Status</th>
            <td rowspan="2">
               <span>LBCSTAT</span>
            </td>
            <td rowspan="2">
               <span>LBSTAT</span>
            </td>
            <td>ServiceRequest.doNotPerform</td>
            <td>
               <p>Observation.basedOn.resolve().doNotPerform</p>
            </td>
            <td rowspan="2">Sponsor may choose to map a situation in which the entire panel is cancelled as one summary record compliant with SDTM IG examples.
Some sponsor may decline to accept cancelled records under specific circumstances (e.g., unscheduled)
Sponsor may also choose to populate LBREASND as CANCELLED<br/>
               <br/>Needs to be translated from FHIR vocabulary to SDTM controlled terminology:   FHIR -&gt; CDISC:
Not performed = NOT DONE
Cancelled = NOT DONE
Completed = &lt;blank&gt;
</td>
         </tr>
         <tr>
            <td>ServiceRequest.status</td>
            <td>
               <p>Observation.basedOn.resolve().status</p>
            </td>
         </tr>
         <tr>
            <th>Reason Test Not Done</th>
            <td/>
            <td>
               <span>LBREASND</span>
            </td>
            <td>Observation.dataAbsentReason</td>
            <td>
               <p>Observation.dataAbsentReason.text</p>
            </td>
            <td>see notes on LBSTAT</td>
         </tr>
         <tr>
            <th>Lab Test or Examination Short Name</th>
            <td/>
            <td>
               <span>LBTESTCD</span>
            </td>
            <td>Observation.code</td>
            <td>
               <p>Observation.code.coding.where(selected=true).code</p>
            </td>
            <td>Translate to compliant terminology (if needed)</td>
         </tr>
         <tr>
            <th>Lab Test or Examination Name</th>
            <td/>
            <td>
               <span>LBTEST</span>
            </td>
            <td>Observation.code</td>
            <td>
               <p>Observation.code.coding.where(selected=true).display</p>
            </td>
            <td>Translate to compliant terminology (if needed)</td>
         </tr>
         <tr>
            <th>Test LOINC Code</th>
            <td>
               <span>LBLOINC</span>
            </td>
            <td>
               <span>LBLOINC</span>
            </td>
            <td>Observation.code</td>
            <td>
               <p>Observation.code.coding.where(system='LOINC').code</p>
            </td>
            <td/>
         </tr>
         <tr>
            <th>Vendor Name</th>
            <td>
               <span>LBNAM</span>
            </td>
            <td>
               <span>LBNAM</span>
            </td>
            <td>Organization.name</td>
            <td>
               <p>Observation.performer.where($this is Organization).resolve().name</p>
            </td>
            <td/>
         </tr>
         <tr>
            <th>Reference Range Indicator</th>
            <td>
               <span>LBCNRIND</span>
            </td>
            <td>
               <span>LBNRIND</span>
            </td>
            <td>Observation.interpretation</td>
            <td>
               <p>Observation.interpretation.where(system ='NRIND')</p>
            </td>
            <td>Must map to CDISC controlled terminology</td>
         </tr>
         <tr>
            <th>Standard Toxicity Grade</th>
            <td/>
            <td>
               <span>LBTOXGR</span>
            </td>
            <td>Observation.interpretation</td>
            <td>
               <p>Observation.interpretation.where(system=[Toxicity Grade]).coding.code</p>
            </td>
            <td>Must map to sponsor-determind terminology</td>
         </tr>
         <tr>
            <th>Toxicity Grade Code List Version</th>
            <td>
               <span>LBCTOXV</span>
            </td>
            <td>
               <span>LBTOX</span>
            </td>
            <td>Observation.interpretation</td>
            <td>
               <p>Observation.interpretation.where(system=[Toxicity Grade]).coding.version</p>
            </td>
            <td>Typically FHIR systems will only populate Coding.version where the terminology is ill-behaved and code meanings change over time.  The code system version doesn't convey what value set the user was choosing from (which could be a subset of the codes from the code system or could draw from multiple code systems).</td>
         </tr>
         <tr>
            <th>Toxicity Grade Code List</th>
            <td>
               <span>LBCTOX</span>
            </td>
            <td>
               <span>LBTOX</span>
            </td>
            <td>Observation.interpretation</td>
            <td>
               <p>Observation.interpretation.where(system=[Toxicity Grade]).system</p>
            </td>
            <td>Note that the system doesn't define the value set nor does it specify value set version or code system version(s)</td>
         </tr>
         <tr>
            <th>Lab Ref Range Lower Limit in Orig Unit</th>
            <td>
               <span>LBORNRLO</span>
            </td>
            <td>
               <span>LBORNRLO</span>
            </td>
            <td>Observation.referenceRange</td>
            <td>
               <p>Observation.referenceRange.low</p>
            </td>
            <td>As reported from the lab.</td>
         </tr>
         <tr>
            <th>Lab Ref Range Upper Limit in Orig Unit</th>
            <td>
               <span>LBORNRHI</span>
            </td>
            <td>
               <span>LBORNRHI</span>
            </td>
            <td>Observation.referenceRange</td>
            <td>
               <p>Observation.referenceRange.high</p>
            </td>
            <td>As reported from the lab.</td>
         </tr>
         <tr>
            <th>Reference Range (for string value)</th>
            <td>
               <span>LBCSTNRC</span>
            </td>
            <td>
               <span>LBSTNRC</span>
            </td>
            <td>Observation.referenceRange</td>
            <td>
               <p>Observation.referenceRange.text</p>
            </td>
            <td>Sponsor would normalize this.</td>
         </tr>
         <tr>
            <th>Lab Result or Finding in Original Units</th>
            <td>
               <span>LBORRES</span>
            </td>
            <td>
               <span>LBORRES</span>
            </td>
            <td>Observation.valueQuantity</td>
            <td>
               <p>Observation.valueQuantity.value</p>
               <p>Observation.valueCodeableConcept.text</p>
            </td>
            <td>Might also include valueQuantity.comparator</td>
         </tr>
         <tr>
            <th>Reported Units</th>
            <td>
               <span>LBRESU</span>
            </td>
            <td>
               <span>LBORRESU</span>
            </td>
            <td>Observation.valueQuantity</td>
            <td>
               <p>Observation.valueQuantity.unit</p>
            </td>
            <td>Needs to be translated to match the controlled terminology, if not already compliant</td>
         </tr>
         <tr>
            <th>Lab Clinical Significance</th>
            <td>
               <span>LBCLSIG</span>
            </td>
            <td>
               <span>SUPPLB.QVAL</span>
            </td>
            <td>Observation.interpretation</td>
            <td>
               <p>Observation.interpretation</p>
            </td>
            <td>As determined by the lab, not the sponsor</td>
         </tr>
         <tr>
            <th>Method</th>
            <td>
               <span>LBCMETH</span>
            </td>
            <td>
               <span>LBMETHOD</span>
            </td>
            <td>Observation.method</td>
            <td>
               <p>Observation.method</p>
            </td>
            <td>Method can cover collection and many other features.  In some cases, collection method may be inferred from the Observation.code.  Would need to map to CDISC controlled terminology</td>
         </tr>
         <tr>
            <th>Anatomical Region </th>
            <td/>
            <td>
               <span>LBLOC*</span>
            </td>
            <td>Specimen.collection.bodySite</td>
            <td>
               <p>Observation.specimen.resolve().collection.bodySite</p>
            </td>
            <td>In some cases, the anatomical location can be inferred from the Observation.code.  Would need to map to CDISC controlled terminology.</td>
         </tr>
         <tr>
            <th>Run ID</th>
            <td>
               <span>LBRUNID</span>
            </td>
            <td>
               <span>LBRUNID*</span>
            </td>
            <td colspan="2" style="background-color:LightGray">Would need to introduce an extension</td>
            <td>May not be applicable for safety labs.</td>
         </tr>
         <tr>
            <th>Unique Subject Identifier</th>
            <td/>
            <td>
               <span>USUBJID</span>
            </td>
            <td>ResearchSubject.identifier</td>
            <td>
               <p>ResearchSubject.where(individual=Observation.subject).identifier.value</p>
            </td>
            <td>To distinguish SUBJID from USUBJID, would need to look at identifier.system</td>
         </tr>
         <tr>
            <th>Result Categorization</th>
            <td>
               <span>LBRESCAT</span>
            </td>
            <td>
               <span>LBRESCAT*</span>
            </td>
            <td>Observation.interpretation</td>
            <td>
               <p>Observation.interpretation</p>
            </td>
            <td>This wouldn't come from the lab.  It *could* be added after the fact.  If so, this would be the mapping</td>
         </tr>
         <tr>
            <th>Anatomical Region</th>
            <td>
               <span>LBANTREG</span>
            </td>
            <td>
               <span>LBANTREG*</span>
            </td>
            <td>Specimen.collection.bodySite</td>
            <td>
               <p>Observation.specimen.resolve().collection.bodySite</p>
            </td>
            <td>Not differentiated from LBLOC.  Not for basic safety labs</td>
         </tr>
         <tr>
            <th>Unscheduled Flag</th>
            <td>
               <span>LBUSCHFL</span>
            </td>
            <td>
               <span>LBUSCHFL*</span>
            </td>
            <td colspan="2" style="background-color:LightGray">This can sort of be inferred from the absence of a link to a PlanDefinition or ActivityDefinition, however there are lots of other reasons these links could be missing, so that's not totally reliable.  Could look at using an extension or a tag<br/>
               <br/>Not generally used for human clinical trials</td>
            <td/>
         </tr>
         <tr>
            <th>Planned Time Point Number</th>
            <td/>
            <td>
               <span>LBTPTNUM</span>
            </td>
            <td colspan="2" style="background-color:LightGray">Pull this information from the Clinical Plan (PlanDefinition)</td>
            <td>Link to the clinical plan would be through the Observation.basedOn link to CarePlan or the instantiatesCanonical link to PlanDefinition or ActivityDefinition</td>
         </tr>
         <tr>
            <th>Analytical Method</th>
            <td/>
            <td>
               <span>LBANMETH*</span>
            </td>
            <td colspan="2" style="background-color:LightGray">This does not apply to safety labs.</td>
            <td>The corresponding values need to be evaluated and aligned accordingly to the CDISC context of --METHOD.
Potentially could appear in Observation.method.  An extension is required to distinguish.</td>
         </tr>
         <tr>
            <th>Baseline Flag</th>
            <td/>
            <td>
               <span>LBBLFL</span>
            </td>
            <td colspan="2" style="background-color:LightGray">Variable may be deprecated.  This information would come from the Sponsor.</td>
            <td>Could appear in Observation.reasonCode.  In practice the notion of 'baseline' is more of a relationship.  Any arbitrary Observation might be selected as the 'baseline' for a particular step in the study.  As such, the real linkage is the tie to the CarePlan activity that's tied to the ActivityDefinition with a reason of 'baseline'.</td>
         </tr>
         <tr>
            <th>Derived Flag</th>
            <td/>
            <td>
               <span>LBDRVFL</span>
            </td>
            <td colspan="2" style="background-color:LightGray">This information would come from the Sponsor.</td>
            <td>FHIR doesn't use a flag.  If an Observation is derived, it should point to the Observations it's derived from with the derivedFrom association.  (If that relationship is present, then the Derived Flag is true)</td>
         </tr>
      </tbody>
   </table>
</div>
